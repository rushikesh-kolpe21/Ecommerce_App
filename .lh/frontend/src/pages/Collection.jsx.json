{
    "sourceFile": "frontend/src/pages/Collection.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1769495726650,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1769495726650,
            "name": "Commit-0",
            "content": "import React, {  useContext, useState,useEffect} from 'react'\r\nimport { ShopContext } from '../context/ShopContext';\r\nimport { assets } from '../assets/assets';\r\nimport { Title } from '../components/Title';\r\nimport { ProductItem } from '../components/ProductItem';\r\n\r\nexport const Collection = () => {\r\n\r\n  const {products, search, showSearch, loading} = useContext(ShopContext);\r\n\r\n\r\n  const [showFilter, setShowFilter] = useState(false);\r\n  const [filteredProducts, setFilteredProducts] = useState([]);\r\n  const [categoryFilter, setCategoryFilter] = useState([]);\r\n  const [typeFilter, setTypeFilter] = useState([]);\r\n  const[sortOption, setSortOption] = useState('relevant');  \r\n\r\n\r\n  // this code for only set category filter [men, women, kids]\r\n  const handleCategoryFilter = (event) => {\r\n    const value = event.target.value;\r\n    // remove item if already present from here only [men, women, kids] not from item list\r\n    if(categoryFilter.includes(value)){\r\n      setCategoryFilter(categoryFilter.filter((item)=> item !== value));\r\n  }\r\n  else{\r\n    // add all item\r\n    setCategoryFilter(prev => [...prev, value])\r\n  }\r\n}\r\n\r\n\r\n// this code for only set type filter [topwear, bottomwear, winterwear]\r\nconst handleTypeFilter=(event)=>{\r\n  const value = event.target.value;\r\n  if(typeFilter.includes(value)){\r\n    // remove item if already present from here only [topwear, bottomwear, winterwear] not from item list\r\n    setTypeFilter(typeFilter.filter((item)=> item !== value));\r\n}else{\r\n  // add all item\r\n  setTypeFilter(prev => [...prev, value]);\r\n}\r\n\r\n}\r\n\r\n\r\n// this code for applying all filters  take men or women form handleCategoryFilter and filter products                                          \r\nconst applyFilters = () => {\r\n  let productsAfterCategoryFilter = products.slice();\r\n\r\n  // search query filter\r\n  if(showSearch && search){\r\n    productsAfterCategoryFilter = productsAfterCategoryFilter.filter((item)=>item.name.toLowerCase().includes(search.toLowerCase()));\r\n  }\r\n  if(categoryFilter.length > 0){\r\n    productsAfterCategoryFilter = productsAfterCategoryFilter.filter((item)=> \r\n      categoryFilter.includes(item.category)\r\n    );\r\n  }\r\n  if(typeFilter.length > 0){\r\n    productsAfterCategoryFilter = productsAfterCategoryFilter.filter((item)=> \r\n      typeFilter.includes(item.subCategory)  //  Type filter is applied\r\n    );\r\n  }\r\n  setFilteredProducts(productsAfterCategoryFilter);\r\n}\r\n\r\n// sorting function\r\nconst sortProducts = ()=> {\r\n\r\n  // create a copy of filteredProducts to avoid mutating state directly\r\n  let filteredProductsCopy = filteredProducts.slice();\r\n  // sorting logic here\r\n  switch(sortOption){\r\n    case 'price_low_high':\r\n  setFilteredProducts(filteredProductsCopy.sort((a,b)=>(a.price - b.price)));\r\n  break;\r\n    case 'price_high_low':\r\n  setFilteredProducts(filteredProductsCopy.sort((a,b)=>(b.price - a.price)));\r\n  break;\r\n  default:\r\n    applyFilters();\r\n  }\r\n}\r\n\r\nuseEffect(()=>{\r\n  sortProducts();\r\n}, [sortOption]);\r\n\r\n\r\n  useEffect(()=>{\r\n    applyFilters();\r\n  }, [categoryFilter, typeFilter,search, showSearch, products]);\r\n  \r\n  \r\n  return (\r\n    <div className='flex flex-col sm:flex-row gap-1 sm:gap-10 pt-10 border-t'>\r\n      {/* filter Option */}\r\n      <div className=' min-w-60'>\r\n        <p onClick={()=>setShowFilter(!showFilter) } className='my-2 text-xl flex items-center cursor-pointer gap-2'>FILTERS <img src={assets.dropdown_icon} \r\n        className={`h-3  sm:hidden ${showFilter ? 'rotate-90' : ''}`} alt=\"\" /></p>\r\n        {/* category */}\r\n        <div className={`border border-gray-300 pl-5 py-3 mt-6 ${showFilter ? 'block' : 'hidden'} sm:block `}>\r\n          <p className='mb-3 text-sm font-medium'>CATEGORIES</p>\r\n          <div className='flex flex-col gap-2 text-sm font-light text-gray-700'>\r\n            <p className='flex gap-2'>\r\n              <input className='w-3' type='checkbox' value={'Men'} onChange={handleCategoryFilter}/>Men\r\n            </p>\r\n             <p className='flex gap-2'>\r\n              <input className='w-3' type='checkbox' value={'Women'} onChange={handleCategoryFilter}/>Women\r\n            </p>\r\n             <p className='flex gap-2'>\r\n              <input className='w-3' type='checkbox' value={'Kids'} onChange={handleCategoryFilter}/>Kids\r\n            </p>\r\n          </div>\r\n        </div>\r\n        {/* subcategory filter */}\r\n         <div className={`border border-gray-300 pl-5 py-3 mt-6 sm:block   ${showFilter ? 'block' : 'hidden'} `}>\r\n          <p className='mb-3 text-sm font-medium'>TYPE</p>\r\n          <div className='flex flex-col gap-2 text-sm font-light text-gray-700'>\r\n            <p className='flex gap-2'>\r\n              <input className='w-3' type='checkbox' value={'Topwear'} onChange={handleTypeFilter}/>Topwear\r\n            </p>\r\n             <p className='flex gap-2'>\r\n              <input className='w-3' type='checkbox' value={'Bottomwear'} onChange={handleTypeFilter}/>Bottomwear\r\n            </p>\r\n             <p className='flex gap-2'>\r\n              <input className='w-3' type='checkbox' value={'Winterwear'} onChange={handleTypeFilter}/>Winterwear\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Right Side */}\r\n      <div className=\"flex-1\">\r\n        <div className=\"flex justify-between text-base sm:text-2xl mb-4\">\r\n          <Title text1={'ALL'} text2={\"COLLECTIONS\"}/>\r\n          {/* product sort */}\r\n          <select onChange={(event)=> setSortOption(event.target.value)} className='border border-gray-300 text-sm px-2'>\r\n            <option value=\"relevant\">Sort by: Relevant</option>\r\n            <option value=\"price_low_high\">Sort by: Low to High</option>\r\n            <option value=\"price_high_low\">Sort by: High to Low</option>\r\n          </select>\r\n        </div>\r\n        {/* map products */}\r\n       <div className='grid grid-cols-2 lg:grid-cols-4 md:grid-cols-3 gap-y-6 gap-4'>\r\n        {\r\n          loading ? (\r\n            <p className='text-center col-span-full'>Loading products...</p>\r\n          ) : filteredProducts.length > 0 ? (\r\n            filteredProducts.map((item, index)=> (\r\n              <ProductItem key={index} name={item.name} id={item._id} price={item.price} image={item.image} />\r\n            ))\r\n          ) : (\r\n            <p className='text-center col-span-full'>No products found</p>\r\n          )\r\n        }\r\n      </div>\r\n\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n"
        }
    ]
}